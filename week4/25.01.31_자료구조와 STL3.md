# 레드-블랙 트리 (Red-Black Tree)

레드-블랙 트리는 **이진 탐색 트리(BST)**의 일종으로, 삽입과 삭제 연산 후에도 균형을 유지하도록 설계된 **균형 이진 트리**이다.

## 1. 레드-블랙 트리의 속성

1. 각 노드는 **빨간색(Red) 또는 검은색(Black)** 이다.
2. 루트 노드는 항상 **검은색**이다.
3. 모든 리프 노드(NIL, NULL)는 **검은색**이다.
4. 빨간색 노드의 자식은 반드시 **검은색**이어야 한다. (즉, 빨간색 노드는 연속될 수 없다.)
5. 모든 경로에서 리프(NIL) 노드까지 가는 **검은색 노드의 개수**는 동일해야 한다.

이러한 속성을 유지하면 트리의 높이가 O(log n)로 유지되며, 탐색, 삽입, 삭제 연산의 시간 복잡도는 **O(log n)** 이 된다.

---

## 2. 삽입 연산 (Insertion)

삽입 연산은 일반적인 **BST 삽입**처럼 수행한 후, 레드-블랙 트리의 속성을 유지하기 위해 **재조정(Rebalancing)** 과정을 수행한다.

### 삽입 과정
1. **BST 삽입**을 수행하고 새로운 노드를 **빨간색(Red)** 으로 설정한다.
2. 삽입된 노드가 루트라면, 검은색으로 변경하고 종료한다.
3. 부모가 검은색이면 종료한다.
4. 부모가 빨간색이면, 삼촌 노드의 색에 따라 **재조정**을 수행한다.

### 삽입 시 재조정 (Fix-up) 경우

#### **Case 1: 삼촌이 빨간색** (Recoloring)
- 삼촌 노드가 **빨간색**이면, 부모와 삼촌을 **검은색**으로 바꾸고, 할아버지를 **빨간색**으로 만든다.
- 이후 할아버지를 기준으로 다시 속성을 검사하고 조정한다.

#### **Case 2: 삼촌이 검은색 & 노드가 부모의 반대 방향 자식** (Rotation + Recoloring)
- **삼촌이 검은색**이고, 삽입된 노드가 **부모의 반대 방향 자식**이면 **회전(Rotation)** 을 수행하여 Case 3으로 변경한다.
- 예: 왼쪽-오른쪽 (LR) 또는 오른쪽-왼쪽 (RL) 형태라면 **부모를 기준으로 회전** 수행.

#### **Case 3: 삼촌이 검은색 & 노드가 부모의 같은 방향 자식** (Rotation + Recoloring)
- **삼촌이 검은색**이고, 삽입된 노드가 **부모의 같은 방향 자식**이면 **회전 + 색 변경** 수행.
- 할아버지를 **회전** 후, 부모와 할아버지의 색을 변경한다.
- 예: 왼쪽-왼쪽 (LL) 또는 오른쪽-오른쪽 (RR) 형태라면 **할아버지를 기준으로 회전** 수행.

---

## 3. 삭제 연산 (Deletion)

레드-블랙 트리에서 삭제는 일반적인 **BST 삭제**처럼 수행한 후, 트리의 속성을 유지하기 위해 **재조정(Fix-up)** 을 수행한다.

### 삭제 과정
1. **BST 삭제**를 수행한다.
2. 삭제된 노드가 **빨간색**이면 트리 속성을 위반하지 않으므로 종료한다.
3. 삭제된 노드가 **검은색**이면, 트리 속성이 깨지므로 **재조정(Fix-up)** 을 수행한다.

### 삭제 시 재조정 (Fix-up) 경우

#### **Case 1: 형제가 빨간색**
- 형제를 **검은색**으로 만들고, 부모를 **빨간색**으로 만든 후, 부모를 기준으로 **회전** 수행.
- 이후 형제의 색이 검은색이 되어 다른 케이스로 전환됨.

#### **Case 2: 형제가 검은색 & 조카가 모두 검은색**
- 형제를 **빨간색**으로 만들고 부모를 기준으로 다시 속성을 검사하며 재조정.
- 부모가 빨간색이면 검은색으로 바꾸고 종료.

#### **Case 3: 형제가 검은색 & 한쪽 조카만 빨간색**
- 빨간색 조카 방향으로 **회전** 후, 형제의 색을 변경하여 Case 4로 변환.

#### **Case 4: 형제가 검은색 & 반대쪽 조카가 빨간색**
- 부모를 기준으로 **회전** 후, 색을 교체하여 속성을 유지.

---

## 4. 회전 (Rotation) 예시

레드-블랙 트리는 **LL, LR, RR, RL** 회전을 수행할 수 있다.

### **1. LL 회전 (Right Rotation)**
- **예제**

  ```
      C
     /
    B
   /
  A
  ```
  위 트리에서 C를 기준으로 **오른쪽 회전(Right Rotation)** 하면:
  ```
    B
   / \
  A   C
  ```

### **2. RR 회전 (Left Rotation)**
- **예제**
  ```
  A
   \
    B
     \
      C
  ```
  위 트리에서 A를 기준으로 **왼쪽 회전(Left Rotation)** 하면:
  ```
    B
   / \
  A   C
  ```

### **3. LR 회전 (Left-Right Rotation)**
- **예제**
  ```
      C
     /
    A
     \
      B
  ```
  A를 기준으로 **왼쪽 회전(Left Rotation)** 후 C를 기준으로 **오른쪽 회전(Right Rotation)** 하면:
  ```
      B
     / \
    A   C
  ```

### **4. RL 회전 (Right-Left Rotation)**
- **예제**
  ```
  A
   \
    C
   /
  B
  ```
  C를 기준으로 **오른쪽 회전(Right Rotation)** 후 A를 기준으로 **왼쪽 회전(Left Rotation)** 하면:
  ```
    B
   / \
  A   C
  ```

---

## 5. 결론

레드-블랙 트리는 **균형을 유지**하면서 삽입 및 삭제를 수행할 수 있는 효율적인 **자기 균형 이진 탐색 트리**이다.
- 삽입 및 삭제 후 트리의 속성을 유지하기 위해 **색 변경**과 **회전**을 수행해야 한다.
- 이를 통해 탐색, 삽입, 삭제 연산이 **O(log n)** 에서 수행될 수 있다.

